<!DOCTYPE html>
<html th:replace="~{fragments/defaultLayout :: layout(~{::title}, ~{::section}, ~{::script}, ~{::link})}">
<head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="../../static/css/pages/initiate.css" th:href="@{/css/pages/initiate.css}">
    <title>Initiate Buying</title>
</head>
<body>
<section>
    <div class="container">
		<h3>Initiate Buying</h3>	

		
        <form class="form-horizontal" th:object="${initiateModel}" th:action="@{/buyingprocess/initiate}" method="post">
            <input type="hidden" th:field="*{procurementId}" />
            <input type="hidden" th:field="*{numberOfPractices}" />
            <input type="hidden" th:field="*{directAwardBundleId}" />

			<div class="alert alert-danger" th:if="${#fields.hasErrors('*')}">
			    <p th:each="err : ${#fields.detailedErrors()}" th:text="${err.global}? ${err.message} : ${err.fieldName + ': ' + err.message}"></p>    
			</div>

			<ul class="nav nav-tabs" role="tablist">
				<li th:each="bundle, info : ${initiateModel.bundles}" th:class="${info.count==1?'active':''}">
				<a th:href="${'#b_' + bundle.id}" role="tab" data-toggle="tab" th:text="${bundle.getName()}"></a>
			</ul>

			<!-- Tab panes -->
			<div class="tab-content">
				<div th:each="bundle, info : ${initiateModel.bundles}" th:class="${'tab-pane ' + (info.count==1?'active':'')}" th:id="${'b_' + bundle.id}">
					<div class="row" th:text="${'Content for ' + bundle.getName()}"></div>
					<div th:each="srvRecipient, info2 : ${initiateModel.srvRecipients}" class="row">
						<div th:text="${srvRecipient.organisation.nameProperCase}" class="col-md-3 srv-recipient-name" ></div>
					</div>
				</div>
			</div>

			<br /><br />        
			<div class="panel panel-default">
				<div class="panel-heading">Additional Configuration</div>
				<div class="panel-body">
					<div class="row">
		                <div class="col-md-3" style="text-align: right;">Number of practices:</div>
						<div class="col-md-3" th:text="${initiateModel.numberOfPractices}"></div>
						
		                <label class="col-md-3 control-label">Number of patients:</label>
						<div th:class="${#fields.hasErrors('numberOfPatients')}? 'col-md-3 has-error' : 'col-md-3'">
			            	<input type="text" th:field="*{numberOfPatients}" class="form-control" placeholder="number of patients" autocomplete="off" />
			                <span th:if="${#fields.hasErrors('numberOfPatients')}" class="help-block">[[${#fields.errors('numberOfPatients')[0]}]]</span>
			            </div>
					</div>
					<div class="row">
		                <label class="col-md-3 control-label">Planned Contract Start:</label>
						<div th:class="${#fields.hasErrors('plannedContractStart')}? 'col-md-3 has-error' : 'col-md-3'">
							<div class="input-group date" data-provide="datepicker" data-date-format="dd/mm/yyyy">
				            	<input type="text" th:field="*{plannedContractStart}" class="form-control" placeholder="contract start date" autocomplete="off" />
				            	<div class="input-group-addon">
	        						<span class="glyphicon glyphicon-th"></span>
	    						</div>
				                <span th:if="${#fields.hasErrors('plannedContractStart')}" class="help-block">[[${#fields.errors('plannedContractStart')[0]}]]</span>
				            </div>
			            </div>
		                <label class="col-md-3 control-label">Contract length</label>
						<div th:class="${#fields.hasErrors('contractMonthsYears')}? 'col-md-1 has-error' : 'col-md-1'">
							<div class="input-group">
							    <select class="form-control" th:field="*{contractMonthsYears}" id="ddlContractMonthsYears" style="width: 80px;">
							    <option value="">Years</option>
							    <option th:each="year : ${initiateModel.possibleContractMonthsYears}" th:value="${year}" th:text="${year + ' year' + (year==1?'':'s')}"></option>
							    </select>
				                <span th:if="${#fields.hasErrors('contractMonthsYears')}" class="help-block">[[${#fields.errors('contractMonthsYears')[0]}]]</span>
				            </div>
			            </div>
						<div th:class="${#fields.hasErrors('contractMonthsYears')}? 'col-md-2 has-error' : 'col-md-2'">
							<div class="input-group">
							    <select class="form-control" th:field="*{contractMonthsMonths}" id="ddlContractMonthsMonths" style="width: 90px;">
							    <option value="">Months</option>
							    <option th:each="month : ${initiateModel.possibleContractMonthsMonths}" th:value="${month}" th:text="${month + ' month' + (month==1?'':'s')}"></option>
							    </select>
				                <span th:if="${#fields.hasErrors('contractMonthsYears')}" class="help-block">[[${#fields.errors('contractMonthsYears')[0]}]]</span>
				            </div>
			            </div>
					</div>
				</div>
				<div class="panel-footer">
					<button id="btnRecalculate" class="btn btn-default" style="display:noneX;" type="button" onclick="forms[0].submit();">Recalculate Prices</button>
				</div>
			
			</div>
		</form>
	</div>
</section>

<script th:inline="javascript">

$( document ).ready(function() {

});

</script>
</body>
</html>